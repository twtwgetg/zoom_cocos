# 天气系统使用说明

## 系统组成

1. **WeatherShaderManager.ts** - 天气效果管理器脚本
2. **WeatherMaterial.mtl** - 天气效果材质
3. **simple-weather.effect** - 天气效果Shader
4. **snow_effect.prefab** - 雪花粒子特效预制体

## 功能特性

### 1. 阴天效果
- 自动调整背景颜色，营造阴天氛围
- 降低饱和度，添加蓝色调
- 平滑过渡动画

### 2. 雪花特效
- 动态生成雪花粒子
- 可调节雪花密度和速度
- 自动在阴天时播放

## 使用方法

### 在场景中使用天气系统

1. 在背景节点上添加 `WeatherShaderManager` 组件
2. 设置以下参数：
   - **Background Sprite**: 背景图片的Sprite组件
   - **Weather Material**: WeatherMaterial材质文件
3. 调用以下方法控制天气：
   - `activateWeatherEffect()` - 激活阴天和雪花效果
   - `deactivateWeatherEffect()` - 取消天气效果
   - `setWeatherIntensity(intensity: number)` - 手动设置天气强度(0-1)

### 与游戏逻辑集成

天气系统已集成到 frm_main.ts 中，当触发冰封效果时会自动激活天气效果。

## 自定义配置

### 调整天气参数
在 `WeatherShaderManager.ts` 中可以调整以下参数：
- `weatherParams.hueShift` - 色相偏移
- `weatherParams.saturation` - 饱和度
- `weatherParams.brightness` - 亮度
- `weatherParams.weatherIntensity` - 天气强度

### 调整雪花效果
在 `createSnowEffect()` 方法中可以调整以下参数：
- `emissionRate` - 粒子发射率
- `life` - 粒子生命周期
- `speed` - 粒子移动速度
- `startSize/endSize` - 粒子起始/结束大小
- `gravity` - 重力影响

## 故障排除

### 天气效果不显示
1. 检查是否正确设置了 Background Sprite 和 Weather Material
2. 确保场景中有背景Sprite组件
3. 检查控制台是否有错误信息

### 雪花效果不显示
1. 检查是否正确创建了粒子系统
2. 确保粒子纹理已正确设置
3. 检查粒子系统的参数配置