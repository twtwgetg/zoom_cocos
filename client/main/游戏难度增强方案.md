# 游戏难度增强方案

## 🎯 难度增强概述
为了让游戏更具挑战性，我们对游戏的多个难度维度进行了全面优化，让玩家在关卡推进过程中体验到逐步递增的挑战。

## 📊 具体难度调整

### ⏰ 1. 时间限制加强
**调整前**：30-100秒
```typescript
// 旧版本
return this.lerp(30, 100, t);
```

**调整后**：25-80秒
```typescript
// 新版本 - 更紧迫的时间压力
return this.lerp(25, 80, t);
```

**影响**：
- 初期关卡减少5秒，增加紧迫感
- 后期关卡减少20秒，显著提升难度
- 整体时间压力增加约20%

### 🔲 2. 网格规模扩大

#### 宽度调整
**调整前**：4 → 6 → 8
**调整后**：4 → 6 → 8 → 10

```typescript
// 新的宽度分布
if (t < 0.15) return 4;      // 早期关卡保持简单
else if (t < 0.4) return 6;  // 中期关卡适中  
else if (t < 0.7) return 8;  // 中后期关卡较难
else return 10;              // 后期关卡非常难
```

#### 高度调整
**调整前**：8 → 10 → 12
**调整后**：8 → 10 → 12 → 14

```typescript
// 新的高度分布
if (t < 0.15) return 8;      // 早期关卡保持简单
else if (t < 0.4) return 10; // 中期关卡适中
else if (t < 0.7) return 12; // 中后期关卡较难
else return 14;              // 后期关卡非常难
```

**影响**：
- 最大网格从 8x12 增加到 10x14
- 卡片总数从96张增加到140张
- 连线难度显著提升

### 🧩 3. 碎片类型复杂化
**调整前**：15-20种类型
**调整后**：18-25种类型

```typescript
// 更多的碎片类型增加识别难度
return Math.floor(this.lerp(18, 25, t));
```

**影响**：
- 初期增加3种类型，提升基础难度
- 最多增加5种类型，后期更具挑战性
- 相似图案增加，考验玩家观察力

### ⚡ 4. 道具冷却时间动态调整
**新增功能**：根据关卡动态调整道具冷却时间

```typescript
// 新增方法：获取道具冷却时间
public static getToolCooldown(level: number): number {
    const t = level / LevelMgr.realmaxlevel;
    // 从15秒增加到25秒
    return this.lerp(15000, 25000, t);
}
```

**应用到冰封道具**：
```typescript
// 根据关卡难度调整冷却时间
const cooldownTime = LevelMgr.getToolCooldown(LevelMgr.level);
this.resetTimeoutId = setTimeout(() => {
    Main.DispEvent('event_fruszon', false);
    this.resetTimeoutId = null;
}, cooldownTime);
```

**影响**：
- 早期关卡：15秒冷却（原来固定15秒）
- 后期关卡：25秒冷却（增加66%）
- 道具使用策略性更强

## 🎮 难度曲线设计

### 关卡进度与难度对应关系

| 关卡进度 | 时间限制 | 网格大小 | 碎片类型 | 道具冷却 | 难度评级 |
|---------|---------|---------|---------|---------|---------|
| 0-15% | 25-30秒 | 4x8 | 18-19种 | 15-16秒 | ⭐ 简单 |
| 15-40% | 30-45秒 | 6x10 | 19-21种 | 16-19秒 | ⭐⭐ 普通 |
| 40-70% | 45-65秒 | 8x12 | 21-23种 | 19-22秒 | ⭐⭐⭐ 困难 |
| 70-100% | 65-80秒 | 10x14 | 23-25种 | 22-25秒 | ⭐⭐⭐⭐ 专家 |

### 💡 新增辅助方法

```typescript
/**
 * 获取关卡难度系数（0-1）
 */
public static getDifficultyFactor(level: number): number {
    return Math.min(level / LevelMgr.realmaxlevel, 1);
}
```

## 🚀 难度增强效果

### 对玩家体验的影响：
1. **更强的挑战感**：时间压力和复杂度同步提升
2. **更高的重玩价值**：后期关卡需要更多策略思考
3. **技能成长感**：明显的难度梯度让玩家感受到进步
4. **道具价值提升**：冷却时间增加让道具更加珍贵

### 对游戏平衡的影响：
1. **防止玩家流失**：早期难度适中，保持可玩性
2. **延长游戏时间**：后期高难度增加单局时长
3. **增强付费动机**：困难关卡可能促进道具购买
4. **提升留存率**：有挑战的内容增加粘性

## 🔧 实现细节

### 修改的文件：
- `assets/script/levelmgr.ts` - 核心难度配置
- `assets/script/gridcreator.ts` - 道具冷却时间调整

### 代码特点：
- **向后兼容**：不影响现有存档
- **参数化配置**：易于后续微调
- **详细日志**：便于难度测试和调优
- **线性插值**：平滑的难度过渡

## 📈 建议的后续优化

1. **数据收集**：统计各关卡通过率和平均用时
2. **动态调整**：根据玩家反馈微调参数
3. **A/B测试**：对比不同难度曲线的效果
4. **特殊关卡**：考虑添加 boss 关卡或特殊挑战

这个难度增强方案确保了游戏在保持可玩性的同时，为资深玩家提供了足够的挑战！